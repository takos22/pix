[{"id":0,"href":"/pix/Accessibilite/","title":"Accessibilit√©","parent":"Pix documentation technique","content":" V√©rifier l\u0026rsquo;accessibilit√© d\u0026rsquo;un site Plusieurs solutions (compl√©mentaires) :\nAller sur https://validator.w3.org/ (y coller l\u0026rsquo;url du site √† tester).\nInstaller l\u0026rsquo;extension de navigateur \u0026ldquo;Wave\u0026rdquo;\nCliquer sur l\u0026rsquo;ic√¥ne de l\u0026rsquo;extension pour v√©rifier s\u0026rsquo;il y a des erreurs en naviguant sur le site. Installer l\u0026rsquo;extension de navigateur \u0026ldquo;Web Developper\u0026rdquo; (de pr√©f√©rence avec Firefox)\nAller dans Informations \u0026gt; View Document Outline pour v√©rifier la hi√©rarchie des titres¬†: Cela devrait correspondre √† l\u0026rsquo;ordre d\u0026rsquo;importance des informations de la page Les num√©ros de balises doivent se suivre : \u0026lt;h1\u0026gt;\u0026lt;h2\u0026gt; ‚úÖ \u0026lt;h1\u0026gt;\u0026lt;h3\u0026gt; üö® Zoomer beaucoup (ctrl +) et v√©rifier si les √©l√©ments ne se superposent pas. Le zoom doit √™tre un zoom du texte, disponible sous Firefox (via le menu affichage \u0026gt; zoom \u0026gt; zoom de texte seulement).\nSi certains √©l√©ments textes d√©bordent (textes qui se superposent, texte qui sort d\u0026rsquo;un bouton), il faudra surement √©viter les hauteurs fixes ; Pour ce qui concerne le texte, les pixels sont √† bannir ! Pr√©f√©rez les unit√©s relatives (rem, \u0026hellip;). Attention, cela ne fonctionne pas toujours de mettre des unit√©s relatives pour les marges, la hauteur, \u0026hellip; Enlever les √©l√©ments graphiques et v√©rifier si on garde toujours l\u0026rsquo;information (par exemple en d√©sactivant le css voire le js d\u0026rsquo;un site). Sur Firefox : Menu Affichage/style de la page/aucun style\nLa s√©mantique des balises Attention √† la s√©mantique (le sens, la signification) des balises ! Cela est tr√®s important notamment pour les lecteurs d\u0026rsquo;√©cran de site web pour les personnes aveugles. Exemple :\n\u0026lt;button\u0026gt; = une action dans le site lui-m√™me \u0026lt;a\u0026gt; = un lien, une redirection vers une autre page ou autre site Utilisation des balises \u0026lt;h*\u0026gt; Peu importe l\u0026rsquo;apparence des h*, les personnes qui voient les titres comprennent. En revanche les personnes qui naviguent avec le clavier au voiceOver ont besoin que le html soit explicite le plus possible pour que leur outil sache les lire correctement.\nConcr√®tement, ce n\u0026rsquo;est pas une mauvaise pratique d\u0026rsquo;avoir un h1 visuellement plus petit/moins contrast√©/, etc. qu\u0026rsquo;un h2. On peut par exemple avoir une publicit√©, qui sera marqu√©e par le titre h1 \u0026ldquo;Publicit√©\u0026rdquo;, mais qui visuellement sera tout petit. L\u0026rsquo;important est de conserver une structure html en cascade pour le voiceOver (et le r√©f√©rencement web).\nAu moins un h1 est n√©cessaire sur chaque page : ce sera le titre de la page. Exemple pour la page d\u0026rsquo;accueil du site service-public : \u0026ldquo;service-public particuliers : conna√Ætre vos droits effectuer vos demandes\u0026rdquo;. C\u0026rsquo;est important de mettre le nom du site global pour avoir du contexte. De plus, ce h1 doit contenir la m√™me chose que le titre de la page.\nOn peut mettre une image dans un titre (exemple : image avec alt=¬´ Pix ¬ª Connectez-vous)\nUtilisation des balises Dans l\u0026rsquo;id√©al les balises div ne servent que pour des √©l√©ments d√©coratifs. Le reste doit avoir une balise sp√©cifique.\nPlus d\u0026rsquo;informations Voir le site du w3c pour la liste des balises.\nQuand mettre un alt sur une image ? Il faut TOUJOURS mettre un alt sur une balise \u0026lt;img\u0026gt;.\nA noter cependant qu\u0026rsquo;il faut mettre l\u0026rsquo;alt vide si l\u0026rsquo;image est \u0026ldquo;d√©corative\u0026rdquo; (c\u0026rsquo;est-√†-dire qu\u0026rsquo;elle peut √™tre enlev√©e sans perdre d\u0026rsquo;informations, par exemple une image de fond). Pour savoir si une image est utile, se poser la question : \u0026ldquo;si on enl√®ve l‚Äôimage, est-ce qu‚Äôil nous manque un information ?\u0026rdquo;\nPour les autres images, jouant le r√¥le de boutons ou de lien etc., le contenu de l\u0026rsquo;alt est primordial. Par exemple, on pr√©f√©rera les formulations :\n\u0026ldquo;Retour vers l\u0026rsquo;accueil de Pix\u0026rdquo; plut√¥t que \u0026ldquo;Logo de Pix\u0026rdquo;, pour expliquer ce que fait le bouton avec l\u0026rsquo;image du logo de Pix dans le footer. \u0026ldquo;Nous suivre sur facebook\u0026rdquo; plut√¥t que \u0026ldquo;Lien vers notre page Facebook\u0026rdquo; (parce que l\u0026rsquo;information \u0026ldquo;lien\u0026rdquo; est d√©j√† contenu dans la balise elle m√™me). \u0026ldquo;Soutenu par le minist√®re de \u0026hellip;\u0026rdquo; plut√¥t que \u0026ldquo;Logo du minist√®re de \u0026hellip;\u0026rdquo; Unit√©s CSS Pour les textes, les pixels sont √† bannir ! Il faut privil√©gier les unit√©s relatives. Utilisation des rem pour les fonts¬†: size, lettering, letter-spaces. Utilisation des px pour le positionnement¬†: padding, border, margin.\n.my-class { size: 1.3rem; padding: 10px 12px; } Navigation Normalement toute page est accessible via :\nBarre de recherche Barre de navigation Plan de site SAUF tunnel d‚Äôachat, etc‚Ä¶\nGraphiques V√©rifier les contraste de couleurs Les couleurs qui portent √† confusion ne doivent pas √™tre c√¥te √† c√¥te (on peut tester cela en convertissant l\u0026rsquo;√©cran en noir et blanc) Mettre des fronti√®res/bordures √©paisses L√©gende en dehors du graphique et compl√®te (pas d\u0026rsquo;ellipse : \u0026hellip;) Pas d‚Äôaffichage au survol Pr√©f√©rer une construction graphique avec une alternative textuelle : tableau portant les donn√©es d√©pli√©es dans un accord√©on en dessous du graphique donn√©es en table, transform√©es visuellement en graphique : les lecteurs d\u0026rsquo;√©cran sauront lire correctement un tableau "},{"id":1,"href":"/pix/Anatomy/","title":"Anatomie de la plateforme","parent":"Pix documentation technique","content":" Organisation g√©n√©rale du code Les applications Pix (Pix API, Pix App, Pix Orga, Pix Certif et Pix Admin) sont organis√©es au travers un d√©p√¥t Git de type monorepo.\npix ‚Üí Sources de la plateforme ‚îî .circleci ‚Üí R√©pertoire de configuration de CircleCI ‚îî config.yml ‚Üí Fichier principal de configuration de CircleCI ‚îî admin ‚Üí Sources de l\u0026#39;application Pix Admin ‚îî api ‚Üí Sources de l\u0026#39;application Pix API ‚îî certif ‚Üí Sources de l\u0026#39;application Pix Certif ‚îî docs ‚Üí R√©pertoire des documents techniques et m√©thodologiques ‚îî adr ‚Üí Registre des ADR (Architecture Decision Records) ‚îî assets ‚Üí Images utilis√©es dans la documentation ‚îî high-level-tests ‚Üí R√©pertoire de tests tr√®s haut niveau ‚îî e2e ‚Üí Tests fonctionnels avec Cypress.js ‚îî load-testing ‚Üí Tests de charge et de performance Artillery.io ‚îî mon-pix ‚Üí Sources de l\u0026#39;application Pix App ‚îî node_modules ‚Üí (g√©n√©r√©) D√©pendances pour les scripts et t√¢ches NPM g√©n√©rales ‚îî orga ‚Üí Sources de l\u0026#39;application Pix Orga ‚îî scripts ‚Üí Divers scripts utilis√©s pour l\u0026#39;exploitation et le support ‚îî .adr-dir ‚Üí Fichier de configuration de l\u0026#39;outil npryce/adr-tools pour g√©rer les ADR ‚îî .buildpacks ‚Üí Fichier de d√©finition des buildpacks Scalingo √† utiliser ‚îî .editorconfig ‚Üí Fichier de configuration pour l\u0026#39;outil / standard EditorConfig ‚îî .eslintrc.yaml ‚Üí Fichier de configuration g√©n√©ral pour l\u0026#39;outil de linting ESLint ‚îî .gitignore ‚Üí Listing des fichiers / r√©pertoires √† ignorer de Git ‚îî .slugignore ‚Üí Listing des fichiers / r√©pertoires que Scalingo doit ignorer au moment du build ‚îî CHANGELOG.md ‚Üí Listing des modifications op√©r√©es sur la plateforme (mise √† jour automatique) ‚îî docker-compose.yml ‚Üí Fichier utilis√© pour les d√©veloppements afin de d√©marrer un environnement iso-prod ‚îî INSTALLATION.md ‚Üí Instructions d\u0026#39;installation de la plateforme en local ‚îî LICENSE.md ‚Üí Texte de la licence logicielle utilis√©e sur Pix (AGPL-3.0) ‚îî nginx.conf.erb ‚Üí Fichier de configuration du reverse proxy / API gateway (Nginx) ‚îî package.json ‚Üí Fichier de d√©finition g√©n√©r√© de la plateforme ‚îî package-lock.json ‚Üí Listing des d√©pendances ‚îî README.md ‚Üí Fichier de pr√©sentation du projet ‚îî scalingo.json ‚Üí Fichier de configuration des Review Apps Scalingo Anatomie d\u0026rsquo;une application Ember cf. Documentation officielle d\u0026rsquo;Ember\nAnatomie de l\u0026rsquo;application Pix API Le code de l\u0026rsquo;application Pix API s\u0026rsquo;inspire des principes formul√©s par Robert C. Martin dans son mod√®le Clean Architecture.\napi ‚Üí Sources de l\u0026#39;application Pix API ‚îî bin ‚Üí R√©pertoire de binaires ‚îî www ‚Üí Binaire d\u0026#39;ex√©cution de l\u0026#39;API ‚îî db ‚Üí Fichiers de configuration et d\u0026#39;alimentation de la BDD ‚îî migrations ‚Üí R√©pertoire des fichiers de migration de la BDD ‚îî seeds ‚Üí R√©pertoire des fichiers d\u0026#39;alimentation de la BDD pour d√©veloppement local ‚îî knex-database-connection.js ‚Üí Fichier de configuration de l\u0026#39;outil de requ√™tage SQL (Knex.js) ‚îî knexfile.js ‚Üí Fichier de configuration des environnements Knex ‚îî lib ‚Üí Sources de l\u0026#39;API ‚îî application ‚Üí Fichiers de d√©finition des routes et contr√¥leurs HTTP ‚îî domain ‚Üí Objets du domaine (entit√©s, aggr√©gats, value objects, services, use cases) ‚îî models ‚Üí Entit√©s, aggr√©gats et value objects du domaine ‚îî services ‚Üí Services m√©tier du domaine ‚îî usecases ‚Üí Cas d\u0026#39;usage m√©tier ‚îî validators ‚Üí Validateurs de r√®gles fonctionnelles ‚îî constants.js ‚Üí Listing des variables m√©tier utilis√©es dans l\u0026#39;application ‚îî errors.js ‚Üí Listing des erreurs m√©tier ‚îî infrastructure ‚Üí Ensemble des modules et briques techniques ‚îî adapters ‚Üí Convertisseurs d\u0026#39;objets issus de sources de donn√©es (PG, Airtable) en objets du domaine ‚îî caches ‚Üí Classes et modules utilis√©s pour le caching de donn√©es ‚îî data ‚Üí Mod√®les de donn√©es Bookshelf ‚îî datasources ‚Üí Mod√®les de donn√©es Airtable ‚îî files ‚Üí Templates de fichiers utilis√©s pour l\u0026#39;import / export de donn√©es ‚îî mailers ‚Üí Classes et modules utilis√©es pour l\u0026#39;envoi d\u0026#39;e-mails ‚îî plugins ‚Üí (d√©pr√©ci√©) Plugins Hapi.js _home made_ ‚îî repositories ‚Üí Gestionnaires d\u0026#39;acc√®s aux donn√©es (PG, Airtable) ‚îî serializers ‚Üí Convertisseurs de donn√©es Domain objects ‚Üê‚Üí HTTP request objects ‚îî utils ‚Üí Ensemble de classes et modules utilitaires ou helpers ‚îî validators ‚Üí (d√©pr√©ci√©) Validateurs techniques ‚îî airtable.js ‚Üí Wrapper de client Airtable ‚îî bookshelf.js ‚Üí Instance de gestionnaire Bookshelf ‚îî logger.js ‚Üí Instance de logger Bunyan ‚îî node_modules ‚Üí (g√©n√©r√©) D√©pendances pour les scripts et t√¢ches NPM g√©n√©rales ‚îî scripts ‚Üí Divers scripts ‚îî tests ‚Üí Sources des tests suites et test cases ‚îî acceptance ‚Üí Tests haut niveau pour les scripts et certaines routes ‚îî docs ‚Üí Tests documentant l\u0026#39;emploi de d√©pendances utilis√©es sur Pix (ex : Bookshelf) ‚îî integration ‚Üí Tests utilis√©es pour couvrir les Routes, les mod√®les Bookshelf, les Repositories, et le traitement de fichiers ‚îî tooling ‚Üí Outillage (Factories, DataBuilders) pratique pour les tests ‚îî unit ‚Üí Tests unitaires (Controllers, Serializers, Models, Services et Usecases du domaine, Validators, etc.) ‚îî .eslintrc.yaml ‚Üí Fichier de configuration g√©n√©ral pour l\u0026#39;outil de linting ESLint ‚îî test-helper.js ‚Üí Module de configuration des libs utilis√©es pour les tests (Mocha, Sinon, Chai, etc.) ‚îî .buildpacks ‚Üí Fichier de d√©finiion des buildpacks Scalingo √† utiliser ‚îî .env ‚Üí (g√©n√©r√©/√©dit√©) Fichier avec les variables d\u0026#39;environnement pour le d√©veloppement local ‚îî .eslintrc.yaml ‚Üí Fichier de configuration g√©n√©ral pour l\u0026#39;outil de linting ESLint ‚îî .istanbul.yml ‚Üí Fichier de configuration pour la couverture de code ‚îî .slugignore ‚Üí Listing des fichiers / r√©pertoires que Scalingo doit ignorer au moment du build ‚îî package.json ‚Üí Fichier de d√©finition g√©n√©r√© de la plateforme ‚îî package-lock.json ‚Üí Listing des d√©pendances ‚îî Procfile ‚Üí Fichier de d√©marrage du conteneur Scalingo ‚îî sample.env ‚Üí Template du fichier .env ‚îî server.js ‚Üí Instance du Web server Hapi.js "},{"id":2,"href":"/pix/API/","title":"API","parent":"Pix documentation technique","content":" Conventions de nommage Les classes prennent une majuscule au d√©but. Les modules et variables prennent une minuscule au d√©but. Sauf exception, privil√©gier l\u0026rsquo;ordre alphab√©tique pour trier une suite de d√©clarations, require, \u0026hellip;\n// BAD const sessionRepository = require(...); const assessmentRepository = require(...); const certificationRepository = require(...); // GOOD const assessmentRepository = require(...); const certificationRepository = require(...); const sessionRepository = require(...); Exemples :\nconst User = require(...); const userRepository = ... const userName = ... Une entit√© du domaine ne contient pas de pr√©fixe.\nconst User = require(\u0026#39;../../User\u0026#39;); const myUser = new User({}); D√©claration de routes Ajout de tags et de notes au moment de la d√©claration des routes de l\u0026rsquo;API.\nserver.route([ { method: \u0026#39;GET\u0026#39;, path: \u0026#39;/api/sessions\u0026#39;, config: { handler: sessionController.find, tags: [\u0026#39;api\u0026#39;, \u0026#39;sessions\u0026#39;], notes: [ \u0026#39;- **Cette route est restreinte aux utilisateurs authentifi√©s avec le r√¥le Pix Master**\\n\u0026#39; + \u0026#39;- Elle permet de consulter la liste de toutes les sessions (retourne un tableau avec n √©l√©ments)\u0026#39;, ] } } ] ); Configuration Options d\u0026rsquo;environnement Toute option de configuration de l\u0026rsquo;API susceptible de d√©pendre d\u0026rsquo;un environnement particulier (production, int√©gration, d√©veloppement ou test), qu\u0026rsquo;elle soit fonctionnelle ou technique, DOIT √™tre d√©finie dans le fichier /api/lib/config.js.\nconfig.config.jsexports = (function() { const config = { // some options‚Ä¶ someCategory: { optionA: \u0026#39;valueA\u0026#39;, optionB: \u0026#39;valueB\u0026#39;, }, // yet other options‚Ä¶ }; return config; })(); L\u0026rsquo;acc√®s √† une variable d\u0026rsquo;environnement NE DOIT PAS √™tre effectu√© en dehors des fichiers `/api/lib/settings.config.\n// BAD /* lib/plugins.js */ if (process.env.LOG_ENABLED === \u0026#39;true\u0026#39;) { consoleReporters.push(\u0026#39;stdout\u0026#39;); } // GOOD /* lib/config.js */ module.exports = (function() { const config = { logging: { enabled: (process.env.LOG_ENABLED === \u0026#39;true\u0026#39;), }, }; return config; })(); /* lib/plugins.js */ const settings = require(\u0026#39;./settings\u0026#39;); if (settings.logging.enabled) { consoleReporters.push(\u0026#39;stdout\u0026#39;); } Toute variable d\u0026rsquo;environnement DOIT √™tre d√©finie dans la page du wiki concern√©e.\nSurcharge d\u0026rsquo;une option par environnement La surcharge d\u0026rsquo;une option pour un environnement d√©di√© DOIT se faire par modification de la valeur plut√¥t que par instanciation d\u0026rsquo;un nouvel objet associ√© √† la cat√©gorie, afin de permettre le m√©canisme de \u0026ldquo;valeur par d√©faut\u0026rdquo; et d\u0026rsquo;√©viter la duplication de code inutile.\nSoit la configuration par d√©faut suivante :\nconst config = { someCategory: { optionA: \u0026#39;valueA\u0026#39;, optionB: \u0026#39;valueB\u0026#39;, optionC: \u0026#39;valueC\u0026#39;, }, }; // BAD if (process.env.NODE_ENV === \u0026#39;test\u0026#39;) { config.someCategory = { optionA: \u0026#39;test_valueA\u0026#39;, optionB: \u0026#39;test_valueB\u0026#39;, optionC: \u0026#39;test_valueC\u0026#39;, }; } // GOOD if (process.env.NODE_ENV === \u0026#39;test\u0026#39;) { config.someCategory.optionA = \u0026#39;test_valueA\u0026#39;; config.someCategory.optionB = \u0026#39;test_valueB\u0026#39;; config.someCategory.optionC = \u0026#39;test_valueC\u0026#39;; } Activation / d√©sactivation des fonctionnalit√©s Dans le cas de fonctionnalit√©s activables/d√©sactivables, l\u0026rsquo;activation DOIT √™tre g√©r√©e via une option bool√©enne enabled.\n// BAD mailing: { enabled: !!process.env.MAILING_ENABLED, } // GOOD mailing: { enabled: (process.env.MAILING_ENABLED === \u0026#39;true\u0026#39;), } Cat√©gorisation des options Toute option DEVRAIT √™tre class√©e dans une cat√©gorie sp√©cifique afin d\u0026rsquo;aider √† comprendre la finalit√©, l\u0026rsquo;usage ou le contexte d\u0026rsquo;ex√©cution de celle-ci.\n// BAD const config = { passwordValidationPattern: \u0026#39;^(?=.*\\\\p{L})(?=.*\\\\d).{8,}$\u0026#39;, }; // GOOD const config = { account: { passwordValidationPattern: \u0026#39;^(?=.*\\\\p{L})(?=.*\\\\d).{8,}$\u0026#39;, }, }; Tests ‚ôªÔ∏è Tests unitaires Un test unitaire doit passer sans base de donn√©es.\nFeature Toggles üó∫Ô∏è Probl√®me On veut pouvoir mettre en prod une fonctionnalit√© (exemple \u0026ldquo;Certification v2\u0026rdquo;), tout en ayant la capacit√© de la d√©sactiver sans g√©n√©rer une nouvelle version de l\u0026rsquo;application pendant les premi√®res semaines.\nSur des fonctionnalit√©s longues √† d√©velopper, on a aussi parfois le besoin de livrer une partie du code en production sans que la fonctionnalit√© associ√©e soit visible par l\u0026rsquo;utilisateur.\nü•ö Solution Ajouter des variables d\u0026rsquo;environnement dont le nom est clairement identifi√© comme feature toggle en utilisant le pr√©fixe FT_ :\nFT_ACTIVATE_CERTIFICATION_V2 = true Dans leur formulation, les variables d\u0026rsquo;env sont en tournure affirmative :\nFT_USE_ONLY_V1_CERTIFICATION plut√¥t que FT_DONT_USE_V2_CERTIFICATION. Leur valeur par d√©faut est false de pr√©f√©rence (=\u0026gt; oublier de l\u0026rsquo;ajouter conserve le comportement actuel de l\u0026rsquo;application).\n‚ö†Ô∏è : il est important de supprimer ces bascules au plus t√¥t, d√®s que la feature est bien install√©e en production (voir r√©f√©rence de Martin Fowler ci-dessous). Les features toggles ne sont pas des configurations qu\u0026rsquo;on souhaite conserver longtemps, ce sont des bascules temporaires.\nAvoir un pr√©fixe bien identifi√© permet de faire la diff√©rence entre les variables d\u0026rsquo;environnement de configuration durables et les variables d\u0026rsquo;environnement de bascules temporaires.\n‚ö†Ô∏è : cette solution de feature toggle doit rester un pis aller quand on ne sait pas d√©couper finement une fonctionnalit√©. √áa ne doit pas devenir un r√©flexe. On ne le fait que quand on n\u0026rsquo;a pas trouv√© de meilleure solution.\nüìñ Informations suppl√©mentaires Pour tester en √©vitant une combinatoire ing√©rable pendant les tests (telle fonctionnalit√© activ√©e avec telle autre d√©sactiv√©e, \u0026hellip;), Martin Fowler propose de ne tester que deux cas :\nTester avec toutes les bascules qui seront effectivement activ√©es lors de la prochaine livraison Tester avec toutes les bascules activ√©es Par exemple, si :\nJ\u0026rsquo;ajoute la bascule FT_ACTIVATE_CERTIFICATION_V2, Et que cette bascule sera d√©sactiv√©e √† la prochaine mise en prod Alors :\nJe teste avec FT_ACTIVATE_CERTIFICATION_V2=false (et l\u0026rsquo;√©tat des autres FT tel qu\u0026rsquo;en production) Je teste avec FT_ACTIVATE_CERTIFICATION_V2=true (et toutes les autres FT activ√©es √©galement) R√©f√©rences https://martinfowler.com/bliki/FeatureToggle.html https://martinfowler.com/articles/feature-toggles.html Voir un exemple d\u0026rsquo;ajout en PR #534, et de suppression en PR #563. "},{"id":3,"href":"/pix/database/","title":"Base de donn√©es","parent":"Pix documentation technique","content":"Ces conventions sont v√©rifi√©es dans la t√¢che de lint de l\u0026rsquo;API.\nNommage Tables Le nom d\u0026rsquo;une table :\nest au pluriel : users et pas user Exceptions Les exceptions possibles sont :\nles tables utilis√©es par les librairies, par exemple la table knex_migrations_lock utilis√©e par la librairie knex; les tables ne contenant qu\u0026rsquo;un seul enregistrement (aucun exemple connu). Dans ce cas, elles peuvent √™tre ajout√©es √† la propri√©t√© ignores du fichier de configuration.\nignores: [ {identifierPattern: \u0026#39;public\\\\.knex*.*\u0026#39;, rulePattern: \u0026#39;.*\u0026#39;}, {identifierPattern: \u0026#39;public\\\\.badge-criteria\u0026#39;, rulePattern: \u0026#39;name-inflection\u0026#39;}, ] "},{"id":4,"href":"/pix/Calcul-Airtable/","title":"Calcul des Pix dans Airtable","parent":"Pix documentation technique","content":" R√®gle de calcul des Pix Rappel de la r√®gle de calcul :\nOn ne consid√®re dans la suite que les Acquis : Ayant le champ¬†Status √†¬†actif ; Associ√© √† au moins une √©preuve ayant le champ Statut √†¬†valid√©,¬†valid√© sans test ou¬†pr√©-valid√©. Associ√© √† une Comp√©tence dont le champ Origine est Pix Pour chaque Acquis : On compte le nombre¬†d\u0026rsquo;acquis : de la m√™me comp√©tence ; et de m√™me niveau. On divise 8 par ce nombre pour obtenir la valeur en Pix ; si le r√©sultat est sup√©rieur √† 4 la valeur est limit√©e √† 4. Ajouter les champs de calcul des Pix Rappel : la hi√©rarchie d\u0026rsquo;objets concern√©e est la suivante :\nChaque Comp√©tence : contient des Tubes‚Ä¶ qui contiennent des Acquis‚Ä¶ qui contiennent des Epreuves. L\u0026rsquo;id√©e est de construire en remontant la liste des niveaux des acquis jusqu\u0026rsquo;√† leur comp√©tence, puis de la redescendre jusqu\u0026rsquo;√† chaque acquis qui peut ensuite d√©terminer combien d\u0026rsquo;acquis dans sa comp√©tence ont le m√™me niveau que lui.\nSont ajout√©s les champs suivants, dans l\u0026rsquo;ordre o√π ils sont √©valu√©s :\nEpreuves.IsValidated qui vaut 1 si l\u0026rsquo;√©preuve est consid√©r√©e \u0026ldquo;valid√©e\u0026rdquo; (r√®gle 1.b), et 0 sinon ; Field type : Formula Formule :¬†IF(OR({Statut}=\u0026ldquo;valid√©\u0026rdquo;, {Statut}=\u0026ldquo;valid√© sans test\u0026rdquo;, {Statut}=\u0026ldquo;pr√©-valid√©\u0026rdquo;), 1,0) Exemple de r√©sultat : 1 Acquis.LevelIfActive qui vaut le niveau (Level) de l\u0026rsquo;acquis si le Status est actif (r√®gle 1.a) et qu\u0026rsquo;il existe¬†une √©preuve valid√©e (r√®gle 1.b), sinon une cha√Æne vide ; Pour savoir s\u0026rsquo;il existe une √©preuve valid√©e, ce champ est un¬†rollup du champ IsValidated des √©preuves associ√©es √† l\u0026rsquo;acquis ; en faisant la somme des IsValidated on sait s\u0026rsquo;il existe¬†ou non une √©preuve valid√©e;¬†Field type : Rollup Formule : IF(AND(SUM(values) \u0026gt; 0, Status=\u0026ldquo;actif\u0026rdquo;), Level, \u0026ldquo;\u0026rdquo;) Exemple de r√©sultat : 3 Tubes.AcquisLevels qui calcule la concat√©nation des¬†LevelIfActive des Acquis contenus dans le tube ; Field type : Rollup¬†Formule : CONCATENATE(values) Exemple de r√©sultat : 1245 Acquis.Origin qui recopie le champ¬†Origine de la comp√©tence sur chacun de ses Tubes ; Field type : Lookup Exemple de r√©sultat : \u0026ldquo;Pix\u0026rdquo; Competences.AcquisLevels qui fait √† son tour la concat√©nation des¬†AcquisLevels remont√©s sur les Tubes ; Field type : Rollup Formule : CONCATENATE(values) Exemple de r√©sultat :¬†1544352134513675445363453124351241234 Tubes.CompetenceAcquisLevels qui recopie le champ¬†AcquisLevels de la comp√©tence sur chacun de ses Tubes ; Field type : Lookup¬†Exemple de r√©sultat :¬†1544352134513675445363453124351241234 Acquis.PixValue qui r√©cup√®re le¬†CompetenceAcquisLevels de son Tube et dispose donc de la liste compl√®te des niveaux d\u0026rsquo;acquis pr√©sents dans sa comp√©tence, et l\u0026rsquo;utilise pour calculer sa valeur en Pix : Si l\u0026rsquo;acquis n\u0026rsquo;est pas actif au sens de la r√®gle 1, sa valeur est simplement mise √† z√©ro ;¬†Si l\u0026rsquo;acquis n\u0026rsquo;est pas d\u0026rsquo;origine Pix, sa valeur est simplement mise √† z√©ro ; Sinon, on doit d√©terminer dans la cha√Æne des niveaux le nombre d\u0026rsquo;occurrences du niveau de l\u0026rsquo;acquis consid√©r√©. Comme Airtable ne fournit pas de fonction donnant directement ce nombre, on calcule la diff√©rence entre la longueur de la cha√Æne originale (ex. 12434132), et cette m√™me cha√Æne dans laquelle on aurait remplac√© notre niveau (ex. 2) par une cha√Æne vide (ex. 143413), ce qui donne bien le nombre d\u0026rsquo;occurrences du niveau dans la comp√©tence ; Il ne reste qu\u0026rsquo;√† diviser 8 par ce nombre et limiter √† 4 le r√©sultat ; Field type : Rollup Formule : IF(LevelIfActive \u0026gt; 0, MIN(4, 8/(LEN(CONCATENATE(values)) - LEN(SUBSTITUTE( CONCATENATE(values),LevelIfActive,\u0026quot;\u0026quot;)))), 0) Noter que m√™me si √† la base on a une simple copie d\u0026rsquo;une valeur de l\u0026rsquo;enregistrement¬†Tube li√©, ce qui correspond plut√¥t √† un¬†lookup on utilise ici un champ de type¬†rollup pour pouvoir appliquer une formule. Du coup on est oblig√© de faire un¬†CONCATENATE(values) pour obtenir la valeur de¬†CompetenceAcquisLevels ; Il est utile de changer le formatage par d√©faut du champ pour afficher quelques d√©cimales ; Exemple de r√©sultat : 1.333 "},{"id":5,"href":"/pix/CSS/","title":"Classes CSS","parent":"Pix documentation technique","content":" Conventions de nommage Privil√©gier le plus possible la Convention Block__Element\u0026ndash;Modifier BEM.\nQuand on reprend l\u0026rsquo;√©l√©ment pour devenir un block, il n\u0026rsquo;est pas obligatoire de reprendre l\u0026rsquo;√©l√©ment parent.\nPar exemple, avec le parent profilv2-header__hexagon-score, l\u0026rsquo;enfant doit devenir hexagon-score__content. On n\u0026rsquo;est pas oblig√© de l\u0026rsquo;appeler profilv2-header-hexagon-score__content.\nSelon BEM, les classes ne doivent pas refl√©ter la structure arborescente du DOM, et √™tre le plus flat possible. Puisque par d√©finition d\u0026rsquo;un block, tout ce qui est de la forme block__element-n est un tout indivisible.\nCr√©ation de classes CSS La cr√©ation de classes CSS peut se faire dans le .hbs ou dans le .js, en fonction du besoin.\nDans le .js Lorsque la classe css n\u0026rsquo;a pas de besoin de propri√©t√©s particuli√®res, il suffit de la d√©clarer dans le .js.\nexport default Component.extend({ classNames: [\u0026#39;hexagon-score\u0026#39;], // qui va rajouter cette class √† la div cr√©√©e par Ember pour injecter le component }); \u0026lt;div class=\u0026#34;hexagon-score__content\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__title\u0026#34;\u0026gt;PIX\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-score\u0026#34;\u0026gt;{{score}}\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-total\u0026#34;\u0026gt;1024\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; Au niveau de la structure html, la div apparaitra sous la forme suivante :\n\u0026lt;div class=\u0026#34;ember-view\u0026#34; id=\u0026#34;ember123\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score__content\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__title\u0026#34;\u0026gt;PIX\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-score\u0026#34;\u0026gt;{{score}}\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-total\u0026#34;\u0026gt;1024\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; Dans le .hbs Lorsque la classe css a besoin de propri√©t√©s particuli√®res, il suffit de la d√©clarer dans le .hbs. Au niveau de la structure html, le structure sera identique au .hbs.\nexport default Component.extend({ // component stuff }); \u0026lt;div class=\u0026#34;hexagon-score\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score__content\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__title\u0026#34;\u0026gt;PIX\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-score\u0026#34;\u0026gt;{{score}}\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;hexagon-score-content__pix-total\u0026#34;\u0026gt;1024\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; Responsabilit√©s Dans une recherche de r√©utilisabilit√© des classes css, il faut dans l\u0026rsquo;id√©al que :\nLe bloc comporte le style. L‚Äô√©l√©ment comporte le positionnement. Le modifier modifie de fa√ßon mineure certaines descriptions de style du bloc. Une modification majeure marque le besoin de cr√©er une nouvelle classe / un nouvel ‚Äúobjet‚Äù css Ces \u0026ldquo;r√®gles\u0026rdquo; ne vont pas forc√©ment s\u0026rsquo;appliquer sur des composants uniques.\nImbrication en poup√©es russes Privil√©gier le plus possible la cr√©ation de classes filles visuellement plus petites que leur classe parente, √† l\u0026rsquo;image des poup√©es russes.\nRegroupements des g√©n√©riques Rassembler les couleurs dans un seul et m√™me fichier .scss (palette.scss ou colors.scss)\nS√©paration des responsabilit√©s S√©parer le style du positionnement. On peut par exemple utiliser @mixin. L\u0026rsquo;id√©e est de dissocier facilement et a minima le style du positionnement pour pouvoir √©ventuellement r√©utiliser le style ailleurs. M√™me si c\u0026rsquo;est pr√©f√©rable, il ne s\u0026rsquo;agit pas forc√©ment de s√©parer les classes au moment du processing.\n// BAD .hexagon-score-content__pix-score { position: absolute; width: 100%; top: 40px; color: $black; font-family: $font-open-sans; font-size: 4.6rem; } // GOOD @mixin hexagon-score-pix-score { color: $black; font-family: $font-open-sans; font-size: 4.6rem; } .hexagon-score-content__pix-score { @include hexagon-score-pix-score; position: absolute; width: 100%; top: 40px; } "},{"id":6,"href":"/pix/Contribuer/","title":"Contribuer √† Pix","parent":"Pix documentation technique","content":"Pour toute contribution, il est essentiel de respecter a minima les points suivants. Pour aller plus loin, vous pouvez parcourir les diff√©rents fichiers pr√©sent√©s dans le README.md\nApplications Le nom des applications respecte le mod√®le suivant \u0026lt;Pix [activity_shortname]\u0026gt; Ex : \u0026ldquo;Pix App\u0026rdquo;, \u0026ldquo;Pix Admin\u0026rdquo;, \u0026ldquo;Pix Orga\u0026rdquo;, \u0026ldquo;Pix API\u0026rdquo;, \u0026ldquo;Pix Certif\u0026rdquo;\nBranche dev ‚ö†Ô∏è On ne merge jamais dev dans une autre branche ‚ö†Ô∏è\nConventions de nommage Nommage des commits Les messages de commit doivent √™tre r√©dig√©s en anglais (d√©cision d\u0026rsquo;√©quipe du 27/04/2017).\n50 caract√®res au maximum pour respecter les conventions de l‚Äô√©cosyst√®me notamment GitHub.\nMajuscule et verbe d‚Äôaction pour √™tre en harmonie avec les conventions de Git.\nSi le message n\u0026rsquo;est pas 100 % autoportant, on peut ajouter une description (apr√®s une ligne vide) qui explique la motivation du commit.\nOn suit la convention que le sujet doit marcher comme une fin de phrase √† If applied, this commit will‚Ä¶ .\nA properly formed Git commit subject line should always be able to complete the following sentence:\nIf applied, this commit will _Your subject line here_ For example:\nIf applied, this commit will _Refactor subsystem X for readability_ If applied, this commit will _Update getting started documentation_ If applied, this commit will _Remove deprecated methods_ If applied, this commit will _Release version 1.0.0_ If applied, this commit will _Merge pull request #123 from user/branch_ Pour aller plus loin :\nCommit messages guide Git SCM commit guidelines https://chris.beams.io/posts/git-commit/ Nommage des branches Format (*) Description Exemples [projet_ref]-[us_id]-[description] Branche qui porte sur le d√©veloppement d\u0026rsquo;une story pf-123-create-account [projet_ref]-[us_id]-bugfix-[description] Branche qui porte sur la correction d\u0026rsquo;un bug pf-124-bugfix-timeout-ko [projet_ref]-[us_id]-cleanup-[description] Branche qui sert √† du refactoring pf-125-cleanup-add-tests [projet_ref]-[us_id]-infra-[description] Branche contenant du code technico-technique pf-126-infra-backup-db [projet_ref]-[us_id]-doc-[description] Branche li√©e √† de la documentation (code ou README) pf-127-doc-readme-live [projet_ref]-[us_id]-hotfix-[description] Branche de correction de bugs de production pf-128-hotfix-regression tech-[description] Branche avec changements techniques tech-upgrade-cicd-script (*) : la description est en anglais\nNommage des Pull Requests Format Le format √† respecter est le suivant : [\u0026lt;TAG\u0026gt;] \u0026lt;DESCRIPTION\u0026gt; (\u0026lt;PROJET_REF-\u0026lt;US_ID\u0026gt;)., ex : \u0026ldquo;[FEATURE] Cr√©ation de compte (US-987).\u0026rdquo;\nTAG Nom Usage FEATURE PR relative √† une story BUGFIX PR relative √† une correction d\u0026rsquo;un bug TECH PR relative √† du code technique / d\u0026rsquo;infra Ce tag nous permet de g√©n√©rer automatiquement un fichier CHANGELOG.md regroupant les modifications d\u0026rsquo;une version √† l\u0026rsquo;autre. Il est possible d\u0026rsquo;utiliser d\u0026rsquo;autres tags mais le CHANGELOG les regroupera comme des modifications \u0026ldquo;Autres\u0026rdquo;.\nLe titre de la PR originel (et donc son tag) reste dans tous les cas affich√© dans chaque ligne du CHANGELOG.\nDESCRIPTION La description de l\u0026rsquo;US doit √™tre en fran√ßais, car il s\u0026rsquo;agit d\u0026rsquo;un produit francophone et qu\u0026rsquo;on souhaite que les gens, m√™me loin de l\u0026rsquo;informatique, s\u0026rsquo;int√©ressent √† notre CHANGELOG.\nOn suit la convention que la description doit marcher comme une fin de phrase √† Une fois merg√©e, cette _pull request_ permettra de ‚Ä¶.\n// BAD // Serialise tout les badgeParnerCompetences // Proposition d\u0026rsquo;ADR pour s√©parer Domain Transactions et Domain Events\n// GOOD // S√©rialiser tout les badgeParnerCompetences // Proposer un ADR pour s√©parer Domain Transactions et Domain Events\nPROJET_REF PROJET_REF correspond √† l\u0026rsquo;abr√©viation du projet logiciel dans notre gestionnaire de tickets.\nUS_ID US_ID correspond √† l\u0026rsquo;identifiant unique de la story dans le Product Backlog, g√©n√©r√© et g√©r√© par notre gestionnaire de tickets.\nNode.js On ne commit le package-lock.json qu\u0026rsquo;en cas de modification du package.json\n"},{"id":7,"href":"/pix/Ember/","title":"Ember","parent":"Pix documentation technique","content":" G√©n√©ral Utilisation de transitionTo √âviter les transistionTo dans le hook model(). Privil√©gier leur utilisation dans l‚ÄôafterModel(), une fois que le mod√®le est charg√©.\n// BAD export default Route.extend({ model() { const store = this.get(\u0026#39;store\u0026#39;); return store.findRecord(\u0026#39;user\u0026#39;, this.get(\u0026#39;session.data.authenticated.userId\u0026#39;)) .then((user) =\u0026gt; { if (user.get(\u0026#39;organizations.length\u0026#39;) \u0026gt; 0) { return this.transitionTo(\u0026#39;board\u0026#39;); } return user; }); }, }); // GOOD export default Route.extend({ model() { return this.store.findRecord(\u0026#39;user\u0026#39;, this.get(\u0026#39;session.data.authenticated.userId\u0026#39;)); }, afterModel(model) { if (model.get(\u0026#39;organizations.length\u0026#39;) \u0026gt; 0) { return this.transitionTo(\u0026#39;board\u0026#39;); } } }); Tests Tester le texte traduit par EmberIntl Afin d\u0026rsquo;√™tre compl√®tement agnostique de la locale de l\u0026rsquo;environnement de test, on privil√©giera le fait de tester les textes traduits en passant par le helper t fourni par ember-intl/test-support. Ainsi, on s\u0026rsquo;affranchira de la contrainte de langue et on se concentrera plut√¥t sur la cl√© de traduction attendue sur un test donn√© (proc√©d√© document√© dans la doc EmberIntl).\nPour tester les textes traduits dans les templates :\nimport { module, test } from \u0026#39;qunit\u0026#39;; import { render } from \u0026#39;@ember/test-helpers\u0026#39;; import hbs from \u0026#39;htmlbars-inline-precompile\u0026#39;; import { setupRenderingTest } from \u0026#39;ember-qunit\u0026#39;; import { setupIntl, t } from \u0026#39;ember-intl/test-support\u0026#39;; module(\u0026#39;Integration | Component | hello\u0026#39;, function(hooks) { setupRenderingTest(hooks); setupIntl(hooks); test(\u0026#39;it should display a welcome message\u0026#39;, async function (assert) { // when await render(hbs`\u0026lt;Hello/\u0026gt;`); // then assert.dom().hasText(t(\u0026#39;pages.hello.welcome-message\u0026#39;)); }); }); De m√™me, pour tout autre texte traduit par un autre biais :\nimport { module, test } from \u0026#39;qunit\u0026#39;; import { setupTest } from \u0026#39;ember-qunit\u0026#39;; import { setupIntl, t } from \u0026#39;ember-intl/test-support\u0026#39;; module(\u0026#39;Unit | Service | Error messages\u0026#39;, function(hooks) { setupRenderingTest(hooks); setupIntl(hooks); test(\u0026#39;should return the message when error code is found\u0026#39;, function(assert) { // given const errorMessages = this.owner.lookup(\u0026#39;service:errorMessages\u0026#39;); // when const message = errorMessages.getErrorMessage(\u0026#39;CAMPAIGN_NAME_IS_REQUIRED\u0026#39;); // then assert.equal(message, t(\u0026#39;api-errors-messages.campaign-creation.name-required\u0026#39;)); }); }); Enfin, si vraiment on souhaite tester une traduction sp√©cifique, il faut alors sp√©cifier la locale lors du setup de test :\nimport { module, test } from \u0026#39;qunit\u0026#39;; import { setupTest } from \u0026#39;ember-qunit\u0026#39;; import { setupIntl, t } from \u0026#39;ember-intl/test-support\u0026#39;; module(\u0026#39;Unit | Service | Error messages\u0026#39;, function(hooks) { setupRenderingTest(hooks); setupIntl(hooks, \u0026#39;fr-fr\u0026#39;); test(\u0026#39;should return the message when error code is found\u0026#39;, function(assert) { // given const errorMessages = this.owner.lookup(\u0026#39;service:errorMessages\u0026#39;); // when const message = errorMessages.getErrorMessage(\u0026#39;CAMPAIGN_NAME_IS_REQUIRED\u0026#39;); // then assert.equal(message, \u0026#39;Le nom de la campagne est obligatoire\u0026#39;); }); }); Note: La pratique n\u0026rsquo;est pas recommand√©e sauf exception\n"},{"id":8,"href":"/pix/","title":"Pix documentation technique","parent":"","content":""},{"id":9,"href":"/pix/pull_request_template/","title":"Pull request template","parent":"Pix documentation technique","content":" :unicorn: Probl√®me D√©crivez ici le besoin ou l\u0026rsquo;intention couvert par cette Pull Request.\n:robot: Solution Ajoutez √† cet endroit, si n√©cessaire, des d√©tails concernant la solution technique retenue et mise en oeuvre, des difficult√©s ou probl√®mes rencontr√©s.\n:rainbow: Remarques Des infos suppl√©mentaires, trucs et astuces ?\n:100: Pour tester Les instructions pour reproduire le probl√®me, les profils de test, le parcours sp√©cifique √† utiliser, etc.\n"},{"id":10,"href":"/pix/Responsive-Design/","title":"Responsive Design","parent":"Pix documentation technique","content":" Dimensionnement La largeur doit prendre soit 100% soit une largeur maximale fixe d√©finie en px.\n// BAD .my-class { width: 70%; } // GOOD .my-class { width: 100%; } // ALSO GOOD .my-class { max-width: 1200px; } Positionnement √âviter le plus possible les valeurs n√©gatives de margin, padding, etc. et privil√©gier les positions absolutes\n// BAD .my-class { display: flex; margin-top: -9875654px; } // GOOD .my-class { position: absolute; top: 20px; left: 5px; right: 24132px; bottom: 12345px; } Pros CSS plus robuste c\u0026rsquo;est √† dire √† quel point mon CSS fait le design attendu lorsque le CSS autour de lui bouge.\nCons Lisibilit√© plus faible puisqu\u0026rsquo;en position absolute, le parent doit √™tre en position relative, etc. On modifie plus de classes que besoin.\n"},{"id":11,"href":"/pix/tags/","title":"Tags","parent":"Pix documentation technique","content":""},{"id":12,"href":"/pix/test/","title":"Tests","parent":"Pix documentation technique","content":" Introduction Ce document rassemble les pratiques constat√©es et faisant consensus, afin de faciliter le d√©veloppement, et notamment les revues de code. Son but n\u0026rsquo;est pas d\u0026rsquo;imposer une pratique, mais de capitaliser les bonnes pratiques.\nFavoriser dans ce document¬†:\nla motivation des choix l\u0026rsquo;utilisation d\u0026rsquo;exemples G√©n√©ralit√©s Vocabulaire Ici:\nobjet ne fait pas r√©f√©rence √† la programmation orient√©e objet composant ne fait pas r√©f√©rence au composant Ember. Ce sont des synonymes pour ce qui est en train d\u0026rsquo;√™tre test√© (anglais : SUT)\nLes objets utilis√©s afin de tester de mani√®re isol√©e sont appel√©s doublures (anglais: test double). Ils regroupent les mocks, stubs, spy, fake, dummy.\nTypes de test Type de test Abbr Anglais Ce qui est v√©rifi√© unitaire TU unit le comportement d\u0026rsquo;une unit√© de code (fonction ou d\u0026rsquo;une m√©thode) de mani√®re isol√©e (ex : pas d\u0026rsquo;appel BDD) int√©gration TI integration le r√©sultat de l\u0026rsquo;interaction de N unit√©s de code (composants) dans une configuration proche de celle de production (ex : BDD, Redis, Nock ) acceptation TA acceptance le fonctionnement d\u0026rsquo;une application (ex: Pix App, Pix API) en limitant les doublures √† ce qu\u0026rsquo;on ne ma√Ætrise pas (ex: Airtable) bout-en-bout E2E end to end le fonctionnement de la plateforme (traverser toutes les couches front et back) Les tests d\u0026rsquo;int√©gration, d\u0026rsquo;acceptation et bout-en-bout v√©rifient l\u0026rsquo;interaction de composants √† des niveaux de plus en plus √©lev√©s, le dernier √©tant le Syst√®me d\u0026rsquo;Information complet.\nLes avantages/inconv√©nients de chaque type de test et la r√©partition de ceux-ci sont d√©crits par la pyramide des tests\nFronti√®res de test Ne pas tester les d√©pendances sortant du d√©p√¥t Git concern√© (ex: depuis le d√©p√¥t pix, ne pas tester pix-ui ou mocha). Ces librairies ou framework sont choisies de telle mani√®re √† ce que l\u0026rsquo;on puisse avoir confiance en elles, elles font l\u0026rsquo;objets de tests dans leur propre d√©p√¥t. En revanche, tester l\u0026rsquo;int√©gration de ces d√©pendances dans le code, notamment des wrappers.\nBack - API Type de test par objet Conteneur Objet Type de test application route int√©gration controller unitaire ________________ ________________________ _______________ domain events unitaire models unitaire read-model unitaire service unitaire use-case unitaire ? use-case int√©gration ? validator int√©gration ________________ ________________________ _______________ infrastructure repository int√©gration serializer unitaire wrapper int√©gration autres unitaire wrapper : tout composant qui encapsule une d√©pendance ou une API\nSendinblueProvider.js airtable.js RedisClient.js Exemple :\nit(\u0026#39;should add a row in the table \u0026#34;organizations\u0026#34;\u0026#39;, async () =\u0026gt; { // given const nbOrganizationsBeforeCreation = await BookshelfOrganization.count(); // when await organizationRepository.create(domainBuilder.buildOrganization()); // then const nbOrganizationsAfterCreation = await BookshelfOrganization.count(); expect(nbOrganizationsAfterCreation).to.equal(nbOrganizationsBeforeCreation + 1); }); Unitaire Exemple:\nuse-case ici composant avec un service, non stubb√© ici Int√©gration L\u0026rsquo;utilisation de Bookshelf, Knex, Nock pour faire des assertions est autoris√©. Exemple:\nentre HAPI et configuration de la route ici Acceptation Exemple:\nsur l\u0026rsquo;application : ici Front G√©n√©ralit√©s Conforme aux pr√©conisations Ember\nType de test par composant Objet Type de test route unitaire route acceptation controller unitaire component int√©gration (rendering) model unitaire serializer unitaire adapter unitaire helper unitaire authenticator unitaire Tracked properties Elles sont test√©es unitairement, peu importe leur nature (component, controller, route)\nBout-en-bout Raison: √©viter les tests manuels, longs et r√©p√©titifs, de non-r√©gression\n"},{"id":13,"href":"/pix/Usecase/","title":"Use-case","parent":"Pix documentation technique","content":" D√©finition Un use-case:\nest une fonction utilise le pattern RORO require seulement des √©l√©ments venant du domaine r√©cup√®rent leurs d√©pendances vers l\u0026rsquo;ext√©rieur en tant que param√®tres donn√©e √† la fonction // BAD const myRepository = require(\u0026#39;../../../infrastructure/repositories/myRepository\u0026#39;); // GOOD const myService = require(../../../domain/services/myService); module.exports = function myUseCase({ param1, param2, param3, repo1, repo2 }) { ... }; Controllers Un controller ne peux pas appeler 2 use-case s√©quentiellement.\n"}]